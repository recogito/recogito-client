---
import { i18n } from 'astro:config/server';
import { getMyProfile } from '@backend/crud';
import { createSupabaseServerClient } from '@backend/supabaseServerClient';

const lang = Astro.preferredLocale || i18n?.defaultLocale || "en";

const supabase = await createSupabaseServerClient(Astro.request, Astro.cookies);

const me = await getMyProfile(supabase);
if (me.error || !me.data) {
  return Astro.redirect(`/${lang}/sign-in`);
} else {
  return Astro.redirect(`/${lang}/projects/`);
}
---
